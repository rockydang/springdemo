function getSelectOption(a,b){var c=b;c.bind("click",function(){var b=$(this).attr("value"),c=$(this).text();a.attr("value",b).find(".val").html(c)})}!function(a){a.fn.selectRange=function(b){var h,i,c=a(this).get(0),d=!1,e=0,f=0,g="";return void 0===b?(d?(h=document.selection.createRange(),i=h.duplicate(),i.moveToElementText(c),i.setEndPoint("EndToEnd",h),e=i.text.length-h.text.length,f=e+h.text.length,g=h.text):(e=c.selectionStart,f=c.selectionEnd,g=c.value.substring(e,f)),{start:e,end:f,text:g}):("number"==typeof b&&(b={start:b,end:b}),d?(h=c.createTextRange(),h.collapse(!0),h.moveStart("character",b.start),h.moveEnd("character",b.end-b.start),h.select()):(c.selectionStart=b.start,c.selectionEnd=b.end,c.focus()),!1)}}(jQuery),function(a){a.insertContent={settings:{typeId:"",hrefId:"",titleId:"",targetId:"",txtareaId:"",sureBtn:"",nstart:"",nend:""},init:function(b){b&&a.extend(a.insertContent.settings,b);var c=a.insertContent.settings;a.insertContent.doInsert(c)},doInsert:function(b){var c=b.txtareaId,d=b.hrefId,e=b.targetId.find("button"),f=b.titleId,g=c.val(),h=b.typeId.find("button"),i=b.sureBtn,j=c.selectRange(),k=j.start,l=j.end,m=j.text;return m?b.nstart==k&&b.nend==l?(alert("请先选择文本～"),!1):(d.val(""),f.val(""),e.attr("value","_blank").find(".val").text("打开新窗口"),h.attr("value","0").find(".val").text("单个添加"),a("#J_myModal").modal("show"),i.bind("click",function(){var i,j;a("#J_myModal").modal("hide"),i='<a class="inserthref" href="'+(d.val()?d.val():"javascript:;")+'"'+' title="'+f.val()+'" target="'+e.attr("value")+'">'+m+"</a>",0==h.attr("value")?(g=g.substring(0,k)+i+g.substring(l),c.val(g)):(j=new RegExp(m,"ig"),g=g.replace(j,i),c.val(g)),b.nstart=k,b.nend=l,c.text(b.wholeTxt),a(this).off("click")}),void 0):(alert("请先选择文本～"),!1)}}}(jQuery),$(document).ready(function(){var b=($("#J_myModal"),$("#J_href")),c=$("#J_title"),d=$("#J_sure"),e=$("#J_target"),f=$("#J_addType");getSelectOption(e.find("button"),e.find(".dropdown-menu a")),getSelectOption(f.find("button"),f.find(".dropdown-menu a")),$(".j_toaddhref").click(function(){var a=$(this).parent().parent().parent().find(".j_txtarea");$.insertContent.init({hrefId:b,titleId:c,targetId:e,typeId:f,sureBtn:d,txtareaId:a})})});
